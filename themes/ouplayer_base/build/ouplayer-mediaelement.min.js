/*! Open Media Player | Â© 2012-2017 The Open University | License: MIT | http://iet-ou.github.io/open-media-player | 2017-07-17 05:14:44 */
/*! Built on MediaElement.js | Copyright 2010-2014, John Dyer | License: MIT | http://mediaelementjs.com */

!function($,W){"use strict";$.log=function(s){"object"==typeof W.console&&$.oup_debug&&W.console.log(1===arguments.length?s:arguments)}}(mejs.$,window),function($,W){"use strict";$.oup_fire=function(el,type){var event,d=W.document;d.createEvent?(event=d.createEvent("Event")).initEvent(type,!0,!0):(event=d.createEventObject()).eventType="on"+type,d.createEvent?el.dispatchEvent(event):el.fireEvent&&el.fireEvent(event.eventType,event)},void 0===$.ender?$.log("Using jquery."):$.log("Using ender."),$.extend(mejs.MepDefaults,{controlsText:"Player controls",loadingText:"loading",currentText:"Current time",durationText:"Total time"}),$.extend(MediaElementPlayer.prototype,{buildoup_shim:function(player,controls,layers,media){var t=this,op=t.options,body=$("body"),con=controls,reset=0,at="aria-label",cl_nop="no-progress",current=con.find(".mejs-currenttime"),duration=con.find(".mejs-duration");con.attr(at,op.controlsText).attr("role","toolbar").attr("lang",op.startLanguage),current.attr(at,op.currentText),duration.attr(at,op.durationText),controls.group=function(){var t=this;return void 0===t.oup_group?t:t.oup_group},media.addEventListener("playing",function(e){$.log(">> "+e.type,e),body.removeClass(cl_nop).addClass("in-progress"),void 0!==e.ended&&e.ended&&(t.media.currentTime=0,t.updateCurrent(),body.removeClass("in-progress").addClass(cl_nop),reset++)},!1),media.addEventListener("play",function(e){reset++,t.media.currentTime>0||reset<2||($.log(">> (re-)play",e),body.removeClass(cl_nop).addClass("in-progress"))},!1),media.addEventListener("ended",function(e){$.log(">> ended",e),t.media.currentTime=reset=0,t.updateCurrent(),body.removeClass("in-progress").addClass(cl_nop)},!1),body.removeClass("in-progress").addClass(cl_nop)}}),$(function(){function oup_check_size(){body.width()<=450?body.addClass(small).removeClass(medium).removeClass(large):body.width()>=720?body.removeClass(small).removeClass(medium).addClass(large):body.removeClass(small).addClass(medium).removeClass(large),$.log(">> check_size, width px: "+body.width())}var body=$("body"),small="width-small",medium="width-medium",large="width-large";$(window).resize(oup_check_size),oup_check_size()})}(mejs.$,window),function($){"use strict";$.extend(mejs.MepDefaults,{mediaerrorText:"Media error",mediaerrorUnknown:"[unknown error]",MEDIA_ERR_ABORTED:"The fetching process for the media resource was aborted by the user agent at the user's request.",MEDIA_ERR_NETWORK:"A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.",MEDIA_ERR_DECODE:"An error of some description occurred while decoding the media resource, after the resource was established to be usable.",MEDIA_ERR_SRC_NOT_SUPPORTED:"The media resource indicated by the `src` attribute was not suitable. <small>(Includes 404 'Not Found')</small>"}),$.oup_error_handler=function(e,selector,player){var op=player.options,code=-1,msg=op.mediaerrorUnknown,error="",errors=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];"error"===e.type&&((code=e.target&&e.target.error&&e.target.error.code)>0&&code<=errors.length&&(msg=op[error=errors[code-1]]),$.log(code+" "+msg),$(selector).prepend("<p class=error><em>"+op.mediaerrorText+":</em> "+msg+" <small>"+error+" ["+code+"]</small></p>"),$(selector).removeClass("hide").addClass("show"))}}(mejs.$),function($){$.extend(mejs.MepDefaults,{showtracksText:"Show captions",hidetracksText:"Hide captions"}),$.extend(MediaElementPlayer.prototype,{buildoup_tracks_shim:function(player,controls,layers,media){var op=this.options,track=null,btn_cc=controls.find(".mejs-captions-button button"),wrap=btn_cc.parent();$.log("Tracks.."),$.log(player.tracks[0]),void 0!==player.tracks[0]&&(track=player.tracks[0],btn_cc.click(function(){null===player.selectedTrack?(player.selectedTrack=track,player.captions.attr("lang",track.srclang),player.displayCaptions(),btn_cc.attr("title",op.hidetracksText),wrap.removeClass("mejs-off").addClass("mejs-on")):(player.captions.hide(),track=player.selectedTrack,player.selectedTrack=null,btn_cc.attr("title",op.showtracksText),wrap.removeClass("mejs-on").addClass("mejs-off"))}),wrap.removeClass("mejs-off").addClass("mejs-on"))}})}(mejs.$),function($){$.extend(mejs.MepDefaults,{playText:"Play",pauseText:"Pause"}),$.extend(MediaElementPlayer.prototype,{buildoup_playpause:function(player,controls,layers,media){function togglePlayPause(which){media.currentTime;"play"===which?(play.removeClass(cl_play).addClass(cl_pause),body.removeClass(cl_play).addClass(cl_pause),btn_play.attr("title",op.pauseText)):(play.removeClass(cl_pause).addClass(cl_play),body.removeClass(cl_pause).addClass(cl_play),btn_play.attr("title",op.playText))}var t=this,op=t.options,cl_play="mejs-play",cl_pause="mejs-pause",body=$("body"),play=$('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+t.id+'" title="'+op.playText+'"></button></div>').appendTo(controls).click(function(e){return e.preventDefault(),media.paused?media.play():media.pause(),!1}),btn_play=play.find("button");togglePlayPause("pse"),media.addEventListener("play",function(){togglePlayPause("play")},!1),media.addEventListener("playing",function(){togglePlayPause("play")},!1),media.addEventListener("pause",function(){togglePlayPause("pse")},!1),media.addEventListener("paused",function(){togglePlayPause("pse")},!1)}})}(mejs.$),function($){$.extend(mejs.MepDefaults,{progressText:"Seek bar",seekSeconds:5}),$.extend(MediaElementPlayer.prototype,{buildoup_progress:function(player,controls,layers,media){$.log("oup_progress"),$('<div class="mejs-time-rail oup-mejs-widget"><span class="mejs-time-total"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(controls),controls.find(".mejs-time-buffering").hide();var t=this,op=t.options,total=controls.find(".mejs-time-total"),loaded=controls.find(".mejs-time-loaded"),current=controls.find(".mejs-time-current"),handle=controls.find(".mejs-time-handle"),timefloat=controls.find(".mejs-time-float"),timefloatcurrent=controls.find(".mejs-time-float-current"),handleMouseMove=function(e){var x=e.pageX,offset=total.offset(),width=total.outerWidth(),percentage=0,newTime=0,pos=x-offset.left;x>offset.left&&x<=width+offset.left&&media.duration&&(newTime=(percentage=(x-offset.left)/width)<=.02?0:percentage*media.duration,mouseIsDown&&media.setCurrentTime(newTime),mejs.MediaFeatures.hasTouch||(timefloat.css("left",pos),timefloatcurrent.html(mejs.Utility.secondsToTimeCode(newTime)),timefloat.show()))},mouseIsDown=!1,mouseIsOver=!1,handleKeyMove=function(sec,e){-1===sec?(media.pause(),media.setCurrentTime(media.duration-2)):media.setCurrentTime(sec),e.preventDefault()},updateSlider=function(e){var sec=media.currentTime,time=mejs.Utility.secondsToTimeCode(sec),d=media.duration;handle.attr({"aria-valuenow":sec,"aria-valuetext":time,"aria-valuemin":0,"aria-valuemax":d,"aria-label":op.progressText,tabindex:0,role:"slider"})};handle.bind("keydown",function(e){if($.log(e),e.keyCode>=35&&e.keyCode<=39)try{var c=media.currentTime;if(void 0!==e.metaKey&&e.metaKey)37==e.keyCode?handleKeyMove(0,e):39==e.keyCode&&handleKeyMove(-1,e);else switch(e.keyCode){case 37:if(!isNaN(media.duration)&&media.duration>0){newTime=Math.max(c-op.seekSeconds,0);media.setCurrentTime(newTime)}break;case 39:if(!isNaN(media.duration)&&media.duration>0){var newTime=Math.min(c+op.seekSeconds,media.duration-2);media.setCurrentTime(newTime)}break;case 36:handleKeyMove(0,e);break;case 35:handleKeyMove(-1,e)}}catch(ex){$.log(ex)}}),total.bind("mousedown",function(e){if(1===e.which)return mouseIsDown=!0,handleMouseMove(e),$(document).bind("mousemove.dur",function(e){handleMouseMove(e)}).bind("mouseup.dur",function(e){mouseIsDown=!1,timefloat.hide(),$(document).unbind(".dur")}),!1}).bind("mouseenter",function(e){mouseIsOver=!0,$(document).bind("mousemove.dur",function(e){handleMouseMove(e)}),mejs.MediaFeatures.hasTouch||timefloat.show()}).bind("mouseleave",function(e){mouseIsOver=!1,mouseIsDown||($(document).unbind(".dur"),timefloat.hide())}),media.addEventListener("progress",function(e){player.setProgressRail(e),player.setCurrentRail(e)},!1),media.addEventListener("timeupdate",function(e){player.setProgressRail(e),player.setCurrentRail(e),updateSlider()},!1),t.loaded=loaded,t.total=total,t.current=current,t.handle=handle},setProgressRail:function(e){var t=this,target=void 0!=e?e.target:t.media,percent=null;target&&target.buffered&&target.buffered.length>0&&target.buffered.end&&target.duration?percent=target.buffered.end(0)/target.duration:target&&void 0!=target.bytesTotal&&target.bytesTotal>0&&void 0!=target.bufferedBytes?percent=target.bufferedBytes/target.bytesTotal:e&&e.lengthComputable&&0!=e.total&&(percent=e.loaded/e.total),null!==percent&&(percent=Math.min(1,Math.max(0,percent)),t.loaded&&t.total&&t.loaded.width(t.total.width()*percent))},setCurrentRail:function(){var t=this;if(void 0!=t.media.currentTime&&t.media.duration&&t.total&&t.handle){var newWidth=t.total.width()*t.media.currentTime/t.media.duration,handlePos=newWidth-t.handle.outerWidth(!0)/2;t.current.width(newWidth),t.handle.css("left",handlePos)}}})}(mejs.$),function($){$.extend(mejs.MepDefaults,{muteonText:"Mute",muteoffText:"Unmute",quieterText:"Quieter",louderText:"Louder",quieterKey:"",louderKey:"",volumeText:"Volume"}),$.extend(MediaElementPlayer.prototype,{buildoup_volume:function(player,controls,layers,media){if($.log("Container..."),$.log(controls.group()),!mejs.MediaFeatures.hasTouch||!this.options.hideVolumeOnTouchDevices){var t=this,op=t.options,volume=$('<div class="oup-volume-widget x-mejs-button mejs-mute"><button type="button" aria-controls="'+t.id+'" title="'+op.muteonText+'" class="oup-mute"></button><span class="oup-display" title="'+op.volumeText+'">11</span><button type="button" aria-controls="'+t.id+'" title="'+op.quieterText+'" class="oup-quieter"></button><button type="button" aria-controls="'+t.id+'" title="'+op.louderText+'" class="oup-louder"></button></div>').appendTo(controls),btn_mute=volume.find(".oup-mute"),btn_quieter=volume.find(".oup-quieter"),btn_louder=volume.find(".oup-louder"),display=volume.find(".oup-display"),displayVolume=function(volume){var vol=Math.round(10*volume);display.html(vol),display.attr("title",op.volumeText+": "+vol)};btn_quieter.attr("accesskey",op.quieterKey),btn_louder.attr("accesskey",op.louderKey),btn_mute.click(function(){media.setMuted(!media.muted),btn_mute.attr("title",media.muted?op.muteoffText:op.muteonText)}),btn_quieter.click(function(){if("native"===media.pluginType||0!==media.currentTime){var v=media.volume;v>.1&&media.setVolume(v-.1)}}),btn_louder.click(function(){var v=media.volume;v<1&&media.setVolume(v+.1)}),media.addEventListener("volumechange",function(e){media.muted?(displayVolume(0),volume.removeClass("mejs-mute").addClass("mejs-unmute")):(displayVolume(media.volume),volume.removeClass("mejs-unmute").addClass("mejs-mute")),$.log("oup_volumechange: "+media.volume+" | "+Math.round(10*media.volume))},!1),t.container.is(":visible")&&(displayVolume(op.startVolume),"native"===media.pluginType&&media.setVolume(op.startVolume))}}})}(mejs.$),function($){$.extend(mejs.MepDefaults,{origin:"*",messagePrefix:"OUPLAYER_MESSAGE"}),$.extend(MediaElementPlayer.prototype,{buildoup_postmessage:function(player,controls,layers,media){if(window.location!==window.parent.location&&void 0!==window.postMessage){var op=this.options;"play pause ended transcript_show transcript_hide".replace(/\w+/g,function(ev){media.addEventListener(ev,function(mev){window.parent.postMessage(op.messagePrefix+":"+mev.type,op.origin),$.log("OUP:message sent, "+mev.type)},!1)})}}})}(mejs.$),function($,W){$.extend(mejs.MepDefaults,{popoutText:"Pop out player",popoutlabelText:"Pop out player, opens in new window",popoutTarget:"_blank",popoutUrl:"#",popoutParams:["height="+W.screen.height,"width="+W.screen.width,"resizable=1","location=1","toolbar=0","menubar=0","status=1"]}),$.extend(MediaElementPlayer.prototype,{buildoup_popout:function(player,controls,layers,media){var t=this,op=t.options;if(!mejs.MediaFeatures.hasTouch&&"#"!==op.popoutUrl)$('<div class="oup-mejs-link mejs-popout-link"><a role="button" href="'+op.popoutUrl+'" target="'+op.popoutTarget+'" aria-controls="'+t.id+'" title="'+op.popoutText+'" aria-label="'+op.popoutlabelText+'"></a></div>').appendTo(controls).click(function(e){if(e.preventDefault(),"#"===op.popoutUrl)return W.alert("OU pop out player: missing 'popoutUrl' !"),!1;var autoplay=!media.paused;media.paused||media.pause();var hash="#t="+mejs.Utility.secondsToTimeCode(media.currentTime).replace(":","m")+"s"+(autoplay?"&play=1":""),params=op.popoutParams.join(",");return window.open(op.popoutUrl+hash,op.popoutTarget,params).moveTo(0,0),$.log("Popout open: "+hash,op.popoutParams),!1})}})}(mejs.$,window),function($){$.extend(mejs.MepDefaults,{showscriptText:"Show script",hidescriptText:"Hide script",transcriptId:null}),$.extend(MediaElementPlayer.prototype,{buildoup_transcript:function(player,controls,layers,media){var t=this,op=t.options,tscript=$("#"+op.transcriptId);if(0!==tscript.length){var body=$("body"),ts_visible=!1,btn=$('<div class="oup-mejs-button mejs-transcript-button"><button type="button" aria-controls="'+t.id+'" title="'+op.showscriptText+'"></button></div>').appendTo(controls).click(function(e){return toggleScript(e)}).find("button"),wrap=btn.parent(),btn_x=$("#"+op.transcriptId+" button"),toggleScript=function(e){return e.preventDefault(),ts_visible?(body.addClass("tscript-hide").removeClass("tscript-show"),wrap.removeClass("mejs-on").addClass("mejs-off"),btn.attr("title",op.showscriptText),$.oup_fire(media,"transcript_hide")):(body.removeClass("tscript-hide").addClass("tscript-show"),wrap.removeClass("mejs-off").addClass("mejs-on"),btn.attr("title",op.hidescriptText),btn_x.focus(),tscript.scrollTop(0),$.oup_fire(media,"transcript_show")),ts_visible=!ts_visible,!1};btn_x.click(toggleScript)}else $.log("Warning: no transcript.")}})}(mejs.$),function($,W){$.extend(mejs.MepDefaults,{qualityText:"Quality",qualityhighText:"High definition",qualitylowText:"Standard definition"}),$.extend(MediaElementPlayer.prototype,{buildoup_quality:function(player,controls,layers,media){if(player.isVideo&&!mejs.MediaFeatures.hasTouch){var t=this,op=t.options;$('<div class="oup-mejs-button mejs-quality-button mejs-high-res" ><button type="button" aria-controls="'+t.id+'" title="'+op.qualityhighText+'"></button></div>').appendTo(controls).click(function(e){return e.preventDefault(),W.alert("High definition: not yet functional!"),!1})}}})}(mejs.$,window),function($){$.extend(mejs.MepDefaults,{optionsText:"More options&hellip;",optionsId:"oup-options"}),$.extend(MediaElementPlayer.prototype,{buildoup_options:function(player,controls,layers,media){function toggleOptionsMenu(e){return e.preventDefault(),opts_visible?(opts_menu.addClass("hide").removeClass("show"),wrap.removeClass(cl_on).addClass(cl_off)):(opts_menu.removeClass("hide").addClass("show"),wrap.removeClass(cl_off).addClass(cl_on)),opts_visible=!opts_visible,!1}var t=this,op=t.options,cl_off="mejs-off",cl_on="mejs-on",opts_menu=$("#"+op.optionsId),opts_visible=!1,wrap=$('<div class="oup-mejs-button mejs-options-button"><button type="button" aria-controls="'+t.id+'" title="'+op.optionsText+'"></button></div>').appendTo(controls).click(function(e){return toggleOptionsMenu(e)}).find("button").parent();$("#"+op.optionsId+" button").click(toggleOptionsMenu)}})}(mejs.$),function($){$.extend(mejs.MepDefaults,{tooltipOffsetX:6,tooltipOffsetY:2,tooltipEvents:"focus blur"}),$.extend(MediaElementPlayer.prototype,{buildoup_tooltip:function(player,controls,layers,media){var op=this.options,is_mouse=!1,tip_visible=!1,tip=$('<div class="oup-tooltip hide" role="tooltip">TIP</div>').appendTo($("body")),toggleTip=function(ev){var left,offY,tg=ev.target,offset=$(tg).offset(),body_width=$("body").width();return tip_visible?(tip.addClass("hide").removeClass("show"),$.log("Tooltip hide..")):is_mouse||(tip.removeClass("hide").addClass("show"),tip.html(tg.title),offY=void 0===$.ender?op.tooltipOffsetY:op.tooltipOffsetY-6,tip.css("top",offset.top-tip.height()-offY+"px"),(left=offset.left)+tip.width()>=body_width&&(left=body_width-tip.width()-op.tooltipOffsetX),tip.css("left",left+"px"),$.log("Tooltip show..")),tip_visible=!tip_visible,!1};controls.find("button");op.tooltipEvents&&($("button,.oup-mejs-link a").bind(op.tooltipEvents,function(e){toggleTip(e)}),$("button,.oup-mejs-link a").mouseover(function(e){-1===op.tooltipEvents.indexOf("mouse")&&(is_mouse=!0)}),$("button,.oup-mejs-link a").mouseout(function(e){is_mouse=!1}))}})}(mejs.$),function($){$.extend(mejs.MepDefaults,{groupMoveControls:null}),$.extend(MediaElementPlayer.prototype,{buildoup_group:function(player,controls,layers,media){var op=this.options;if(op.groupMoveControls){var group=$('<div class="oup-group"></div>').appendTo(controls);controls.oup_group=group,$(op.groupMoveControls).appendTo(group),$.log("Init controls group",op.groupMoveControls)}}})}(mejs.$),function($,W){"use strict";$.extend(mejs.MepDefaults,{fsHoverPosX:85,fsHoverPosY:17,fsHoverTimeout:2500,fsHoverAltButton:!1}),$.extend(MediaElementPlayer.prototype,{buildoup_fullscreenhover:function(player,controls,layers,media){function myPositionFullscreenButton(){var flash=$("#me_flash_0");media.positionFullscreenButton(flash.width()-op.fsHoverPosX,flash.height()-op.fsHoverPosY,!0)}function myClearTimeout(){null!==hideTimeout&&(W.clearTimeout(hideTimeout),hideTimeout=null)}var hideTimeout,op=this.options;player.isVideo&&(!0===op.fsHoverAltButton?$("body").addClass("fullscreen-alt-btn"):"string"==typeof op.fsHoverAltButton&&$("body").addClass("fullscreen-alt-btn-"+op.fsHoverAltButton),($("body").hasClass("ua-msie")||$("body").hasClass("br-MSIE"))&&(void 0===$.fn.jquery||/^1\.(0|1|2|3|4|5|6)/.test($.fn.jquery)?$.log("Warning: MSIE fullscreen shim requires jQuery 1.7+ - upgrade needed."):($.log("Fullscreen shim loading.. "+$.fn.jquery),op.fsHoverAltButton&&W.setTimeout(function(){myPositionFullscreenButton()},500),media.addEventListener("play",function(){op.fsHoverAltButton&&(myClearTimeout(),hideTimeout=W.setTimeout(function(){media.hideFullscreenButton()},op.fsHoverTimeout)),$(player.container).on("mouseover",".mejs-layer, .mejs-mediaelement",function(ev){media.positionFullscreenButton&&(myClearTimeout(),myPositionFullscreenButton())}),$(player.container).on("mouseout",".mejs-layer, .mejs-mediaelement",function(ev){media.hideFullscreenButton&&(myClearTimeout(),hideTimeout=W.setTimeout(function(){media.hideFullscreenButton()},op.fsHoverTimeout))})},!1),media.addEventListener("pause",function(){myClearTimeout(),op.fsHoverAltButton&&myPositionFullscreenButton()},!1))))}})}(mejs.$,window),function($,W){$.extend(mejs.MepDefaults,{embedcodeId:null}),$.extend(MediaElementPlayer.prototype,{buildoup_copyembed:function(player,controls,layers,media){var op=this.options,embed=$("#"+op.embedcodeId);embed?embed.bind("focus click",function(ev){W.document.getElementById(op.embedcodeId).select(),embed.mouseup(function(e){void 0!==e.preventDefault&&e.preventDefault()}),$.log("Embed code selected")}):$.log("Warning: no embed code found")}})}(mejs.$,window),function($,W){function oup_detect_ignore_color(){var body=$("body"),hcmclass="no-ignore-color",testcolor=$("<p style='position:absolute;top:0;left:-999px;background-color:#878787;'>T</p>").css("background-color").toLowerCase();mejs.isIgnoreColor="#878787"!==testcolor&&"rgb(135, 135, 135)"!==testcolor,mejs.isIgnoreColor&&(hcmclass="ignore-color"),body.removeClass("ignore-color no-ignore-color").addClass(hcmclass),$.log("> "+hcmclass)}$(window).resize(oup_detect_ignore_color),$(function(){oup_detect_ignore_color(),W.setInterval(oup_detect_ignore_color,5e3)})}(mejs.$,window),function($){$.extend(mejs.MepDefaults,{streamText:"Live"}),$.extend(MediaElementPlayer.prototype,{buildoup_stream:function(player,controls,layers,media){var op=this.options;$('<div class="oup-mejs-stream oup-widget"><i></i>'+op.streamText+"</div>").appendTo(controls)}})}(mejs.$);
//# sourceMappingURL=ouplayer-mediaelement.min.js.map